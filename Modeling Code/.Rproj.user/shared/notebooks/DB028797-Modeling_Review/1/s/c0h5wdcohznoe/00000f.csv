"0","Horvitz_Thompson<-function(p_hat,ch){"
"0","  nan=nrow(ch)"
"0","  ns=ncol(ch)"
"0","  N_hat<-list()"
"0","  n_mat<-matrix(NA,nan,ns)"
"0","  for(j in 1:ns){"
"0","    for(i in 1:nan){"
"0","      n_mat[[i,j]]<-if(ch[[i,j]]>=1){"
"0","        1/p_hat[[i,j]]"
"0","      } else {0}"
"0","    }"
"0","    N_hat[[j]]=sum(n_mat[,j])"
"0","  }"
"0","  return(N_hat)"
"0","}"
"0",""
