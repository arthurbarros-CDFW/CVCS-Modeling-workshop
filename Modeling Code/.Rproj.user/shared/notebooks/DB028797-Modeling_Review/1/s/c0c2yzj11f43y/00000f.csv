"0","total_escapement<-function(ch,beta,cap_X,surv_X){"
"0","  "
"0","  p_hat<-fill_prob_matrices(ch,beta,"
"0","                          cap_X,"
"0","                          surv_X)$p_hat"
"0","  s_hat<-fill_prob_matrices(ch,beta,"
"0","                          cap_X ,"
"0","                          surv_X)$s_hat"
"0","  "
"0","  N_hat=Horvitz_Thompson(p_hat,ch)"
"0",""
"0","  Bstar=B_star(ch,s_hat,p_hat)"
"0",""
"0","  escapement<-N_hat[[2]]*(log(mean(s_hat[,1]))/(mean(s_hat[,1])-1)) + "
"0","  sum(Bstar,na.rm=T)"
"0","  "
"0","  return(ceiling(escapement))"
"0","}"
