"0","B_star<-function(ch,s_hat,p_hat){"
"0","  R=n=list()"
"0","  nan=nrow(ch)"
"0","  ns=ncol(ch)"
"0","  for(j in 1:ns){"
"0","    d<-ch #select just the capture matrix data"
"0","    R[j]<-as.numeric(length(which(d[j]==1)))"
"0","    n[j]<-as.numeric(length(which(d[j]==1))+length(which(d[j]==2)))"
"0","  }"
"0","  "
"0","  N_hat<-Horvitz_Thompson(p_hat,ch)"
"0","  #next B1, or total number of births for each period"
"0","  B1<-list()"
"0","  for(j in 2:(ns-2)){"
"0","    B1[j]<-N_hat[[j+1]]-mean(s_hat[,j])*(N_hat[[j]]-(n[[j]]-R[[j]]))"
"0","  }"
"0","  "
"0","  #next Bstar, number of births adjusted for those entering the system between"
"0","  #j and j+1, but not surviving to j+1"
"0","  Bstar<-NULL"
"0","  for(j in 2:(ns-2)){"
"0","    Bstar[j]<-as.numeric(B1[[j]]*(log(mean(s_hat[,j]))/(mean(s_hat[,j])-1)))"
"0","  }"
"0","  Bstar<-Bstar[-(1)]"
"0","  return(Bstar)"
"0","}"
"0",""
